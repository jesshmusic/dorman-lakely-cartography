<div class="dlc-download-container">
  <!-- Map Info -->
  <div class="dlc-download-header">
    <div class="dlc-download-map-info">
      {{#if map.thumbnail}}
        <img src="{{map.thumbnail}}" alt="{{map.name}}" class="dlc-download-thumbnail" />
      {{/if}}
      <div>
        <h3>{{map.name}}</h3>
        <p class="dlc-download-path">
          <i class="fas fa-folder"></i> {{downloadPath}}
        </p>
      </div>
    </div>
  </div>

  <!-- Download Progress -->
  <div class="dlc-download-content">
    {{#if completed}}
      <!-- Completion Status -->
      <div class="dlc-download-complete">
        <i class="fas fa-check-circle"></i>
        <h3>Download Complete!</h3>
        <p>
          Successfully downloaded {{progress.completedFiles}} file{{#if (gt progress.completedFiles 1)}}s{{/if}}
          {{#if progress.failedFiles}}
            with {{progress.failedFiles}} error{{#if (gt progress.failedFiles 1)}}s{{/if}}
          {{/if}}
        </p>
      </div>
    {{else}}
      <!-- Download Progress -->
      <div class="dlc-download-progress">
        <h4>Downloading {{map.name}}...</h4>

        <div class="dlc-progress-stats">
          <span><i class="fas fa-check-circle"></i> {{progress.completedFiles}}/{{progress.totalFiles}} files</span>
          {{#if progress.failedFiles}}
            <span class="dlc-error"><i class="fas fa-exclamation-circle"></i> {{progress.failedFiles}} failed</span>
          {{/if}}
        </div>

        <div class="dlc-progress-bar-container">
          <div class="dlc-progress-bar" style="width: {{#if progress.totalFiles}}{{divide (multiply progress.completedFiles 100) progress.totalFiles}}{{else}}0{{/if}}%"></div>
        </div>

        {{#if progress.currentFile}}
          <p class="dlc-current-file">
            <i class="fas fa-spinner fa-spin"></i> {{progress.currentFile}}
          </p>
        {{/if}}
      </div>
    {{/if}}
  </div>

  <!-- Actions -->
  <footer class="dlc-download-footer">
    {{#if completed}}
      <button type="button" data-action="close" class="dlc-btn dlc-btn-primary">
        <i class="fas fa-check"></i> Close
      </button>
    {{else if downloading}}
      <button type="button" data-action="cancelDownload" class="dlc-btn dlc-btn-danger">
        <i class="fas fa-times"></i> Cancel
      </button>
    {{/if}}
  </footer>
</div>
